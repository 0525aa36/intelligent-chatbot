### API Test for Intelligent Chatbot with Gemini API
### Server URL
@baseUrl = http://localhost:8080
@contentType = application/json

### Variables (will be set after login)
# @token = your-token-here

###############################################
# 1. 회원가입 (Sign Up)
###############################################

POST {{baseUrl}}/api/auth/signup
Content-Type: {{contentType}}

{
  "email": "0525aa36@gmail.com",
  "password": "password1234",
  "name": "석재민"
}

###############################################
# 2. 로그인 (Login)
###############################################

POST {{baseUrl}}/api/auth/login
Content-Type: {{contentType}}

{
  "email": "0525aa36@gmail.com",
  "password": "password123",
}

> {%
    client.global.set("token", response.body.data.accessToken);
    client.log("Token saved: " + response.body.data.accessToken);
%}

###############################################
# 3. 채팅 생성 - 일반 응답 (Gemini API)
###############################################

POST {{baseUrl}}/api/chats
Content-Type: {{contentType}}
Authorization: Bearer {{token}}

{
  "question": "안녕하세요! Google Gemini API가 잘 작동하나요?",
  "isStreaming": false
}

###############################################
# 4. 채팅 생성 - 간단한 질문
###############################################

POST {{baseUrl}}/api/chats
Content-Type: {{contentType}}
Authorization: Bearer {{token}}

{
  "question": "1+1은 얼마인가요?",
  "isStreaming": false
}

###############################################
# 5. 채팅 생성 - 복잡한 질문
###############################################

POST {{baseUrl}}/api/chats
Content-Type: {{contentType}}
Authorization: Bearer {{token}}

{
  "question": "스프링 부트와 코틀린을 사용한 RESTful API 개발의 장점을 설명해주세요",
  "isStreaming": false
}

###############################################
# 6. 채팅 생성 - 스트리밍 응답 (SSE)
###############################################

POST {{baseUrl}}/api/chats
Content-Type: {{contentType}}
Authorization: Bearer {{token}}

{
  "question": "인공지능이란 무엇인가요?",
  "isStreaming": true
}

###############################################
# 7. 채팅 목록 조회 (페이지네이션)
###############################################

GET {{baseUrl}}/api/chats?page=0&size=10&sort=desc
Authorization: Bearer {{token}}

###############################################
# 8. 특정 모델 지정 - Gemini 2.5 Pro
###############################################

POST {{baseUrl}}/api/chats
Content-Type: {{contentType}}
Authorization: Bearer {{token}}

{
  "question": "머신러닝과 딥러닝의 차이점은 무엇인가요?",
  "isStreaming": false,
  "model": "gemini-2.5-pro"
}

###############################################
# 9. 스레드 삭제
###############################################

DELETE {{baseUrl}}/api/chats/threads/10
Authorization: Bearer {{token}}

###############################################
# 10. 관리자 - 통계 조회 (관리자 권한 필요)
###############################################

GET {{baseUrl}}/api/admin/statistics
Authorization: Bearer {{token}}

###############################################
# 11. 관리자 - 채팅 보고서 다운로드 (CSV)
###############################################

GET {{baseUrl}}/api/admin/reports/chat
Authorization: Bearer {{token}}

###############################################
# 12. 피드백 생성
###############################################

POST {{baseUrl}}/api/feedbacks
Content-Type: {{contentType}}
Authorization: Bearer {{token}}

{
  "chatId": 11,
  "isPositive": true
}

###############################################
# 13. 피드백 생성 - 부정적 피드백
###############################################

POST {{baseUrl}}/api/feedbacks
Content-Type: {{contentType}}
Authorization: Bearer {{token}}

{
  "chatId": 12,
  "isPositive": false
}

###############################################
# 14. 피드백 목록 조회
###############################################

GET {{baseUrl}}/api/feedbacks?page=0&size=10&sort=desc
Authorization: Bearer {{token}}

###############################################
# 15. 피드백 목록 조회 - 긍정 필터
###############################################

GET {{baseUrl}}/api/feedbacks?page=0&size=10&sort=desc&isPositive=true
Authorization: Bearer {{token}}

###############################################
# 16. 피드백 목록 조회 - 부정 필터
###############################################

GET {{baseUrl}}/api/feedbacks?page=0&size=10&sort=desc&isPositive=false
Authorization: Bearer {{token}}

###############################################
# 17. 피드백 상태 변경 (관리자 전용)
###############################################

PATCH {{baseUrl}}/api/feedbacks/1/status
Content-Type: {{contentType}}
Authorization: Bearer {{token}}

{
  "status": "RESOLVED"
}

###############################################
# 테스트 시나리오
###############################################

### 시나리오 1: 회원가입 → 로그인 → 채팅
# 1. 위의 "회원가입" 실행 (새 사용자인 경우)
# 2. "로그인" 실행 (토큰 자동 저장됨)
# 3. "채팅 생성 - 일반 응답" 실행

### 시나리오 2: 다양한 질문 테스트
# 1. "로그인" 먼저 실행
# 2. "간단한 질문", "복잡한 질문" 순서대로 테스트
# 3. "채팅 목록 조회"로 결과 확인

### 시나리오 3: 스트리밍 응답 테스트
# 1. "로그인" 실행
# 2. "채팅 생성 - 스트리밍 응답" 실행
# 3. SSE 형식으로 실시간 응답 확인
